<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<title>Add a GeoJSON line</title>
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no" />
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.js"></script>
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.1.1/mapbox-gl.css" rel="stylesheet" />

	<style>
		body {
			margin: 0;
			padding: 0;
		}

		#map {
			position: absolute;
			top: 0;
			bottom: 0;
			width: 100%;
		}
	</style>

</head>

<body>
	<div id="map"></div>
	<script>
		mapboxgl.accessToken = 'pk.eyJ1IjoibmlubGluIiwiYSI6ImNqanR0Zzc4bzI5b2Ezd2xlb2ZmbzdrOHMifQ.nhMfjVcApf7oZVzhlMnRLA';
		var map = new mapboxgl.Map({
			container: 'map',
			style: 'mapbox://styles/mapbox/streets-v11',
			center: [44.67, 43.025],
			zoom: 12
		});

		map.on('load', function() {
			map.addSource('route', {
				'type': 'geojson',
				'data': {
					'type': 'FeatureCollection',
					'features': [{
							"type": "Feature",
							"properties": {
								"name": "улица Гагарина",
								"osm_id": 178257759.0,
								"length": 1597.5333751098037,
								"checked": 1.0,
								"Old": 0.0,
								"Local": "0",
								"Year": 1961.0,
								"date_type": "renamed",
								"category_simple": "cosmonaut",
								"sub_category": null,
								"reason": "полет в космос",
								"category_reason": "событие",
								"comments": "Отмечая блестящую победу Союза Советских Социалистических Республик в запуске космического корабля-спутника «Восток» с человеком на борту",
								"Gender": 1.0,
								"Human": 1.0,
								"occupation": null,
								"Born": null,
								"Dead": null,
								"full_name": null,
								"name_prev": "улица Пятигорская",
								"year_prev": 1959.0,
								"cat_prev": "geo",
								'color': '#F7455D'
							},
							"geometry": {
								"type": "LineString",
								"coordinates": [
									[44.6687498, 43.0286706],
									[44.6686076, 43.0286266],
									[44.6685436, 43.0286055],
									[44.6672328, 43.0281724],
									[44.6670915, 43.0281257],
									[44.6669593, 43.028082],
									[44.6668335, 43.0280386],
									[44.66563, 43.0276238],
									[44.66551, 43.0275825],
									[44.6653692, 43.0275316],
									[44.6643895, 43.0271778],
									[44.6642859, 43.0271404],
									[44.6641351, 43.027093],
									[44.663095, 43.0267659],
									[44.66297, 43.0267266],
									[44.6628544, 43.0266908],
									[44.6619456, 43.0263729],
									[44.6612124, 43.0261376],
									[44.6599877, 43.0257462],
									[44.6589838, 43.0254162],
									[44.6567242, 43.024677],
									[44.656004, 43.0244488],
									[44.6559561, 43.0244299],
									[44.6557291, 43.0243164],
									[44.6555957, 43.0242637],
									[44.6554019, 43.0241939],
									[44.6540086, 43.0236925],
									[44.6520925, 43.0230121],
									[44.6509826, 43.0226122]
								]
							}
						},
						{
							"type": "Feature",
							"properties": {
								"name": "улица Гагкаева",
								"osm_id": 119984863.0,
								"length": 1711.5260586517995,
								"checked": 1.0,
								"Old": 0.0,
								"Local": "1",
								"Year": 1990.0,
								"date_type": "named",
								"category_simple": "military",
								"sub_category": "вов",
								"reason": "С целью увековечения имен видных деятелей литературы и искусства Северной Осетии и Героев Великой Отечественной войны",
								"category_reason": null,
								"comments": null,
								"Gender": 1.0,
								"Human": 1.0,
								"occupation": "старший лейтенант, Герой Советского Союза",
								"Born": "1917",
								"Dead": "1943",
								"full_name": null,
								"name_prev": null,
								"year_prev": null,
								"cat_prev": null,
								"color": '#33C9EB'
							},
							"geometry": {
								"type": "MultiLineString",
								"coordinates": [
									[
										[44.6200545, 43.0494011],
										[44.6194625, 43.0487598],
										[44.618613, 43.0478395],
										[44.6180143, 43.047191],
										[44.6164893, 43.0455388],
										[44.6161578, 43.0451797],
										[44.6159022, 43.0449028],
										[44.6156395, 43.0446133]
									],
									[
										[44.6200545, 43.0494011],
										[44.6201053, 43.0494498],
										[44.6201412, 43.0494977],
										[44.6216688, 43.0511651],
										[44.6219192, 43.0514566],
										[44.6225731, 43.0522124],
										[44.6231887, 43.052912],
										[44.6236693, 43.0534373],
										[44.6242269, 43.0540506],
										[44.6243829, 43.054149]
									],
									[
										[44.6250193, 43.0550126],
										[44.6266858, 43.0568036]
									],
									[
										[44.6248015, 43.0548696],
										[44.6244544, 43.0544761],
										[44.6244009, 43.0544241]
									],
									[
										[44.6243829, 43.054149],
										[44.6245426, 43.054335]
									],
									[
										[44.6245426, 43.054335],
										[44.6245866, 43.0543764],
										[44.6247668, 43.0546165],
										[44.6249787, 43.0548826],
										[44.6250193, 43.0550126]
									],
									[
										[44.6250193, 43.0550126],
										[44.6249303, 43.0549813],
										[44.6248015, 43.0548696]
									]
								]
							}
						},

					]

				}
			});
			map.addLayer({
				'id': 'route',
				'type': 'line',
				'source': 'route',
				'layout': {
					'line-join': 'round',
					'line-cap': 'round'
				},
				'paint': {
					'line-color': ['get', 'color'],
					'line-width': 3
				}
			});

			var popup = new mapboxgl.Popup({
				closeButton: false,
				closeOnClick: false
			});

			map.on('mouseenter', 'route', function(e) {
				map.getCanvas().style.cursor = 'pointer';

				var coordinates = e.features[0].geometry.coordinates.slice();
				var description = e.features[0].properties.name;


				// Ensure that if the map is zoomed out such that multiple
				// copies of the feature are visible, the popup appears
				// over the copy being pointed to.


				// Populate the popup and set its coordinates
				// based on the feature found.
				popup
					.setLngLat(e.lngLat)
					.setHTML(description + "<p class = 'a'>Hello</p>")
					.addTo(map);
			});
			map.on('mouseleave', 'route', function() {
				map.getCanvas().style.cursor = '';
				popup.remove();
			});
		});
	</script>

</body>

</html>
